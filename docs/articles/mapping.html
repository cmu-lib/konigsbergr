<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mapping and Analyzing Konigsbergr Graphs â€¢ konigsbergr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mapping and Analyzing Konigsbergr Graphs">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">konigsbergr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/konigsbergr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mapping.html">Mapping and Analyzing Konigsbergr Graphs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cmu-lib/konigsbergr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Mapping and Analyzing Konigsbergr Graphs</h1>
                        <h4 class="author">Matthew Lincoln</h4>
            
            <h4 class="date">2019-09-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cmu-lib/konigsbergr/blob/master/vignettes/mapping.Rmd"><code>vignettes/mapping.Rmd</code></a></small>
      <div class="hidden name"><code>mapping.Rmd</code></div>

    </div>

    
    
<p>konigsbergr includes a few functions to map its road graphs and analyze the resulting road network.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(konigsbergr)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(igraph)</span></code></pre></div>
<div id="converting-to-sf" class="section level2">
<h2 class="hasAnchor">
<a href="#converting-to-sf" class="anchor"></a>Converting to sf</h2>
<p>In the getting-started guide, you used the <code><a href="../reference/view_konigsberg_path.html">view_konigsberg_path()</a></code> function to take a graph and comptued pathway and plot it into an interactive <a href="">leaflet</a> map. This top-level function wraps a few lower-level functions that you may want to use if you intend to dig into the spatial information in these networks.</p>
<p>I recommend using the <a href="https://www.r-spatial.org/">sf</a> package for manipulating spatial information in R. sf uses a construct called an <code>sfc</code> object, which is a data frame with a <code>geometry</code> column, in which the spatial description of a given feature (be it a <code>POINT</code>, <code>LINESTRING</code>, <code>POLYGON</code>, <code>MULTIPOLYGON</code>, or what have you) is stored alongside any non-spatial metadata about that feature.</p>
<p><code><a href="../reference/graph_to_sf.html">graph_to_sf()</a></code> takes the graph produced by <code><a href="../reference/konigsberg_graph.html">konigsberg_graph()</a></code> and uses the latitude and longitude vertex attributes to construct two <code>sfc</code> objects - one for the graph vertices, and one for its edges. You can plot out the points that result from converting the graph vertices, or plot the lines that result from converting the graph edges.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>boston_konigsbergr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/konigsberg_graph.html">konigsberg_graph</a></span>(boston)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#&gt; Creating base graph...complete!</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; Adding OSM attributes...complete!</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; Filtering graph to desired paths and bridges...complete!</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>boston_sf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/graph_to_sf.html">graph_to_sf</a></span>(boston_konigsbergr)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(boston_sf<span class="op">$</span>vertices[<span class="st">"geometry"</span>])</span></code></pre></div>
<p><img src="mapping_files/figure-html/plot-normal-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(boston_sf<span class="op">$</span>edges[<span class="st">"geometry"</span>])</span></code></pre></div>
<p><img src="mapping_files/figure-html/plot-normal-2.png" width="700"></p>
<p>All of the vertex and edge attributes from the graph are included in the <code>sfc</code> table, so you can quickly visualize different road types, etc. For much more in-depth discussion of how to make custom plots of <code>sfc</code> objects, or how to export them into other software like ArcGIS, <a href="https://r-spatial.github.io/sf/articles/sf5.html">see the sf plotting documentation</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(boston_sf<span class="op">$</span>edges[<span class="st">"highway"</span>])</span></code></pre></div>
<p><img src="mapping_files/figure-html/plot-variables-1.png" width="700"></p>
<p>Computed konigsbergr pathways can similarly be converted into <code>sfc</code> objects using the <code><a href="../reference/pathway_to_sf.html">pathway_to_sf()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>boston_path &lt;-<span class="st"> </span><span class="kw"><a href="../reference/traverse_graph.html">cross_all_bridges</a></span>(boston_konigsbergr, <span class="dt">starting_node =</span> <span class="dv">2688967592</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; Pre-calculating distance matrices...full matrix...inter-bundle matrix...intra-bundle matrix...done.</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; Running greedy search...done.</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; Extrapolating full paths...</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; done.</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; Completed a path with 15 steps crossing 248 edges and 9 bundles.</span></span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>path_sf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pathway_to_sf.html">pathway_to_sf</a></span>(boston_konigsbergr, boston_path)</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(path_sf<span class="op">$</span>pathway[<span class="st">"geometry"</span>])</span></code></pre></div>
<p><img src="mapping_files/figure-html/plot-path-1.png" width="700"></p>
</div>
<div id="network-analysis-with-konigsbergr-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#network-analysis-with-konigsbergr-graphs" class="anchor"></a>Network Analysis with Konigsbergr graphs</h2>
<p>Raw Konigsbergr graphs contain a huge number of vertices in order to accurately describe the geometry of curved roads. For many network analyses, however, road curvature is unimportant compared to the toplogocal layout of intersections. Simplifying OSM-based road graphs like this can reduce the size of a graph by up to 90%. Some measures dependent on numbers of vertices, like closeness, will also benefit from removing topologically-redundant vertices</p>
<p>Beware that this simplifcation also reduces the data to a simple, undirected graph, so the distinction between two-way and one-way roads will be discarded. The sum of the total distances of the removed edges are maintained, however, so the real-world distance in meters of an edge will be saved in the distance edge attribute of the new graph.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">vcount</a></span>(boston_konigsbergr)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; [1] 2605</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/gsize.html">ecount</a></span>(boston_konigsbergr)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; [1] 3579</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a>simple_boston &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simplify_konigsbergr.html">simplify_konigsbergr</a></span>(boston_konigsbergr)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">vcount</a></span>(simple_boston)</span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; [1] 396</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/gsize.html">ecount</a></span>(simple_boston)</span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; [1] 524</span></span>
<span id="cb6-12"><a href="#cb6-12"></a></span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>simple_boston_sf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/graph_to_sf.html">graph_to_sf</a></span>(simple_boston)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(simple_boston_sf<span class="op">$</span>edges[<span class="st">"distance"</span>])</span></code></pre></div>
<p><img src="mapping_files/figure-html/simplification-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#converting-to-sf">Converting to sf</a></li>
      <li><a href="#network-analysis-with-konigsbergr-graphs">Network Analysis with Konigsbergr graphs</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Lincoln.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
